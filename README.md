# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –ê–≤—Ç–æ—Ä—Å—Ç–≤–æ/–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ 

[egprog](https://t.me/egprog "–Ω—É —ç—Ç —è ") - Full-Stack AI/ML SRE Engeenier<br>

[tazik](https://t.me/tazikwithoutokroshki "–∞ —ç—Ç –∞—Ä—Ç–µ–º") - BackSecOps Engeenier

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∏—Å—Ç–µ–º—É –Ω–∞ –±–∞–∑–µ Arduino, –∫–æ—Ç–æ—Ä–∞—è —É–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ç—ã—Ä—å–º—è —Å–µ—Ä–≤–æ–º–æ—Ç–æ—Ä–∞–º–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ —Ç–æ—á–∫–∞–º–∏. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ GPS, –≥–∏—Ä–æ—Å–∫–æ–ø–∞ –∏ –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è.

## 2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- **GPS-–Ω–∞–≤–∏–≥–∞—Ü–∏—è:** –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ —Ç–µ–∫—É—â–µ–º –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏ —Å –ø–æ–º–æ—â—å—é –º–æ–¥—É–ª—è GPS –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ —Ü–µ–ª–µ–≤–æ–π —Ç–æ—á–∫–∏.
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ—Ç–æ—Ä–∞–º–∏:** –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è (bearing), —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–∞—â–µ–Ω–∏—è —á–µ—Ç—ã—Ä–µ—Ö —Å–µ—Ä–≤–æ–º–æ—Ç–æ—Ä–æ–≤.
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥–∞—Ç—á–∏–∫–∞–º–∏:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≥–∏—Ä–æ—Å–∫–æ–ø –∏ –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è.

## 3. –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

- `Wire.h`: –î–ª—è —Ä–∞–±–æ—Ç—ã —Å I2C-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏.
- `Adafruit_Sensor.h`: –ë–∞–∑–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç—á–∏–∫–∞–º–∏ Adafruit.
- `Adafruit_L3GD20_U.h`: –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–∏—Ä–æ—Å–∫–æ–ø–æ–º L3GD20.
- `Adafruit_MPU6050.h`: –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–æ–º –∏ –≥–∏—Ä–æ—Å–∫–æ–ø–æ–º MPU6050.
- `SoftwareSerial.h`: –î–ª—è —Ä–∞–±–æ—Ç—ã —Å GPS-–º–æ–¥—É–ª–µ–º —á–µ—Ä–µ–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç.
- `TinyGPS++.h`: –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö GPS.
- `Servo.h`: –î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–æ–º–æ—Ç–æ—Ä–∞–º–∏.

## 4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

- **GPS-–º–æ–¥—É–ª—å:** –ü–æ–¥–∫–ª—é—á–µ–Ω –∫ –ø–∏–Ω–∞–º 4 (RX) –∏ 3 (TX) —á–µ—Ä–µ–∑ SoftwareSerial.
- **MPU6050:** –ü–æ–¥–∫–ª—é—á–µ–Ω –ø–æ I2C (SDA –∏ SCL).
- **L3GD20:** –ü–æ–¥–∫–ª—é—á–µ–Ω –ø–æ I2C (SDA –∏ SCL).
- **–°–µ—Ä–≤–æ–º–æ—Ç–æ—Ä—ã:** –ü–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –ø–∏–Ω–∞–º 3, 5, 6 –∏ 9.

## 5. –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

### 5.1 `setup()`

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã:

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è GPS-–º–æ–¥—É–ª—è.
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–æ–º–æ—Ç–æ—Ä–æ–≤.
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–∏—Ä–æ—Å–∫–æ–ø–∞ –∏ –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–∞.

### 5.2 `loop()`

–û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –ø—Ä–æ–≥—Ä–∞–º–º—ã:

- –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö GPS.
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è.
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ —Ü–µ–ª–µ–≤–æ–π —Ç–æ—á–∫–∏.
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–æ–º–æ—Ç–æ—Ä–∞–º–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è.

### 5.3 `getDistance(float lat1, float lon1, float lat2, float lon2)`

–í—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–≤—É–º—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ —Ç–æ—á–∫–∞–º–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–æ—Ä–º—É–ª—ã –≥–∞–≤–µ—Ä—Å–∏–Ω—É—Å–æ–≤.

### 5.4 `getBearing(float lat1, float lon1, float lat2, float lon2)`

–í—ã—á–∏—Å–ª—è–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (bearing) –æ—Ç —Ç–µ–∫—É—â–µ–π —Ç–æ—á–∫–∏ –¥–æ —Ü–µ–ª–µ–≤–æ–π —Ç–æ—á–∫–∏.

### 5.5 `controlMotors(float bearing)`

–†–µ–≥—É–ª–∏—Ä—É–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–∞—â–µ–Ω–∏—è —Å–µ—Ä–≤–æ–º–æ—Ç–æ—Ä–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è.

## 6. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫ Arduino –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º.
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥ –Ω–∞ Arduino.
3. –û—Ç–∫—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
4. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—á–Ω–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –∫ —Ü–µ–ª–µ–≤–æ–π —Ç–æ—á–∫–µ (latB, lonB).

## 7. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Arduino IDE (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è 1.8.x –∏–ª–∏ –≤—ã—à–µ).
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Adafruit MPU6050, Adafruit L3GD20, TinyGPS++.

## 8. –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è GPS-–º–æ–¥—É–ª—è.
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –º–æ—Ç–æ—Ä–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ —Ü–µ–ª–∏.
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞—Ç—á–∏–∫–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.

## 9. –ö–æ–¥ –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã

```cpp
#include <Wire.h>
#include <Adafruit_Sensor.h>
#include <Adafruit_L3GD20_U.h>
#include <Adafruit_MPU6050.h>
#include <SoftwareSerial.h>
#include <TinyGPS++.h>
#include <Servo.h>

#define MOTOR1_PIN 3
#define MOTOR2_PIN 5
#define MOTOR3_PIN 6
#define MOTOR4_PIN 9
Adafruit_MPU6050 mpu;
Adafruit_L3GD20_Unified gyro;

SoftwareSerial ss(4, 3); //rx, rt
TinyGPSPlus gps;

Servo motor1, motor2, motor3, motor4;

float latA = 40.7128;
float lonA = -74.0060;
float latB = 40.7306;
float lonB = -73.9352;

void setup() {
  Serial.begin(9600);
  ss.begin(9600);
  
  motor1.attach(MOTOR1_PIN);
  motor2.attach(MOTOR2_PIN);
  motor3.attach(MOTOR3_PIN);
  motor4.attach(MOTOR4_PIN);
  if (!mpu.begin()) {
    Serial.println("Failed to initialize MPU6050!");
    while (1);
  }

  if (!gyro.begin()) {
    Serial.println("Failed to initialize Gyroscope!");
    while (1);
  }
  
  Serial.println("Initializing GPS...");
  delay(1000);
}

void loop() {
  while (ss.available() > 0) {
    gps.encode(ss.read());
  }

  if (gps.location.isUpdated()) {
    float currentLat = gps.location.lat();
    float currentLon = gps.location.lng();
    
    Serial.print("Current Location: ");
    Serial.print("Lat: "); Serial.print(currentLat, 6);
    Serial.print(" Lon: "); Serial.println(currentLon, 6);
    
    if (currentLat != latB && currentLon != lonB) {
      float distance = getDistance(currentLat, currentLon, latB, lonB);
      float bearing = getBearing(currentLat, currentLon, latB, lonB);
      
      controlMotors(bearing);
    }
  }
}

float getDistance(float lat1, float lon1, float lat2, float lon2) {
  float lat1Rad = radians(lat1);
  float lon1Rad = radians(lon1);
  float lat2Rad = radians(lat2);
  float lon2Rad = radians(lon2);
  
  float dlat = lat2Rad - lat1Rad;
  float dlon = lon2Rad - lon1Rad;
  
  float a = sin(dlat / 2) * sin(dlat / 2) + cos(lat1Rad) * cos(lat2Rad) * sin(dlon / 2) * sin(dlon / 2);
  float c = 2 * atan2(sqrt(a), sqrt(1 - a));
  float distance = 6371 * c; 
  
  return distance;
}

float getBearing(float lat1, float lon1, float lat2, float lon2) {
  float lat1Rad = radians(lat1);
  float lon1Rad = radians(lon1);
  float lat2Rad = radians(lat2);
  float lon2Rad = radians(lon2);
  
  float dLon = lon2Rad - lon1Rad;
  
  float y = sin(dLon) * cos(lat2Rad);
  float x = cos(lat1Rad) * sin(lat2Rad) - sin(lat1Rad) * cos(lat2Rad) * cos(dLon);
  
  float bearing = atan2(y, x);
  bearing = degrees(bearing);
  if (bearing < 0) bearing += 360;
  
  return bearing;
}

void controlMotors(float bearing) {
  int baseSpeed = 1500;
  
  if (bearing < 90) {
    motor1.write(baseSpeed + 20);
    motor2.write(baseSpeed);
    motor3.write(baseSpeed); 
    motor4.write(baseSpeed + 20); 

    } else if (bearing >= 90 && bearing < 180) {
    motor1.write(baseSpeed);
    motor2.write(baseSpeed + 20); 
    motor3.write(baseSpeed + 20); 
    motor4.write(baseSpeed); 
  } else if (bearing >= 180 && bearing < 270) {
    motor1.write(baseSpeed + 20); 
    motor2.write(baseSpeed); 
    motor3.write(baseSpeed); 
    motor4.write(baseSpeed + 20); 
  } else {
    motor1.write(baseSpeed); 
    motor2.write(baseSpeed + 20); 
    motor3.write(baseSpeed + 20); 
    motor4.write(baseSpeed); 
  }
}
```

## 10. –°–ø–∞—Å–∏–±–æ –†–ö–°–ò! ‚ù§Ô∏è

–ü—Ä–æ–µ–∫—Ç —Å–¥–µ–ª–∞–Ω –ø—Ä–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –†–æ—Å—Ç–æ–≤—Å–∫–æ–≥–æ –ö–æ–ª–ª–µ–¥–∂–∞ –°–≤—è–∑–∏ –∏ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏. –•–æ—á–µ—Ç—Å—è –æ—Ç–º–µ—Ç–∏—Ç—å –¢—Ä–∏—â—É–∫ –°–æ—Ñ–∏—é –ê—Ä—Ç—ë–º–æ–≤–Ω—É –∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –∏ –°—É–ª–∞–≤–∫–æ –°–µ—Ä–≥–µ—è –ù–∏–∫–æ–ª–∞–µ–≤–∏—á–∞ –∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ **Arduino Uno R3** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ú—ã –±—ã –æ—á–µ–Ω—å —Ö–æ—Ç–µ–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –º–æ—Ç–æ—Ä—ã –∏ –¥–∞—Ç—á–∏–∫–∏, —á—Ç–æ–±—ã –Ω–∞—à –¥—Ä–æ–Ω –º–æ–≥ –ø–æ–ª–µ—Ç–µ—Ç—å –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É! üôèüèªüôèüèªüôèüèª

